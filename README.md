# Домашнее задание к занятию "11.02 Микросервисы: принципы"
 
Вы работаете в крупной компанию, которая строит систему на основе микросервисной архитектуры.
Вам как DevOps специалисту необходимо выдвинуть предложение по организации инфраструктуры, для разработки и эксплуатации.

## Задача 1: API Gateway 

Предложите решение для обеспечения реализации API Gateway. Составьте сравнительную таблицу возможностей различных программных решений. На основе таблицы сделайте выбор решения.

Решение должно соответствовать следующим требованиям:
- Маршрутизация запросов к нужному сервису на основе конфигурации
- Возможность проверки аутентификационной информации в запросах
- Обеспечение терминации HTTPS

Обоснуйте свой выбор.    

  **Ответ:**   
                                                                                    Шаблоны API Gateway
  |                               |Центральный, пограничный шлюз|Двухуровневый (многоуровневый) шлюз|Микрошлюз|Шлюз для каждого модуля|Sidecar,Service Mesh|    
  |-------------------------------|:---------------------------:|:---------------------------------:|:-------:|:---------------------:|:------------------:|       
  |SSL/TLS                        |             +               |                +                  |    +    |           +           |           +        |
  |Аутентификация                 |             +               |                +                  |    +    |           +           |           +        |
  |Авторизация                    |             +               |                +                  |    -    |           -           |           +        |
  |Маршрутизация запросов         |             +               |                +                  |    +    |           +           |           -        |
  |Ограничение скорости           |             +               |                -                  |    +    |           +           |           -        |
  |Манипуляция запросом/ответом   |             +               |                -                  |    -    |           -           |           -        |
  |Централизированное логирование |             -               |                +                  |    -    |           -           |           +        | 
  |Отслеживание иньекций          |             -               |                +                  |    -    |           -           |           +        |
  |Фасадная маршрутизация         |             +               |                -                  |    -    |           -           |           -        |
  |Балансировки нагрузки          |             -               |                +                  |    +    |           -           |           +        |
  |**Выводы**                     | Подходит для монолитных приложений с централизованным управлением | Подходит для рассредоточенных сервисов и независимого масштабирования, не поддерживает распределенное управление| Предназначены для совместной работы с микросервисами, могут затруднить достижение согласованности и контроля|Не нужно перенастраивать при изменении топологии приложения, не выполняет маршрутизации или балансировки нагрузки, поэтому часто требуется  один из других шаблонов| Сложен в управлении, подходит для нескольких команд разработки|   
  
  Проанализировав таблицу для реализации решения преложил бы микрошлюзы или шлюзы для каждого модуля. Удовлетворяют всем требованиям задачи. Исключил решение "Двухуровневый шлюз", так как оно может вызвать проблемы, когда несколько команд управляют разными средами и приложениями,так ка это решение не поддерживает распределенное управление и исключил решение "Центральный шлюз", так как оно все ткаи больше подходит для монолитных приложений.   
  
  *Используемый материал:* https://www.nginx.com/blog/choosing-the-right-api-gateway-pattern
  
  
## Задача 2: Брокер сообщений

Составьте таблицу возможностей различных брокеров сообщений. На основе таблицы сделайте обоснованный выбор решения.

Решение должно соответствовать следующим требованиям:
- Поддержка кластеризации для обеспечения надежности
- Хранение сообщений на диске в процессе доставки
- Высокая скорость работы
- Поддержка различных форматов сообщений
- Разделение прав доступа к различным потокам сообщений
- Простота эксплуатации

Обоснуйте свой выбор.   

   **Ответ:**   
   
  |                               |RabbitMQ|ActiveMQ|Qpid C++|SwiftMQ|Artemis|Apollo|
  |-------------------------------|:------:|:------:|:------:|:-----:|:-----:|:----:|
  |Кластеризация                  |   +    |    +   |    +   |   +   |   +   |   -  |
  |Хранение сообщений             |   +    |    +   |    +   |   +   |   +   |   +  |
  |Высокая скорость работы        |   +    |    -   |    -   |   -   |   -   |   -  |
  |Поддержка различных форматов   |   +    |    +   |    -   |   -   |   -   |   +  |
  |Разделение прав доступа        |   +    |    +   |    +   |   +   |   +   |   +  |
  |Простота эксплуатации          |   +    |    -   |    -   |   -   |   -   |   -  |     
  
  Согласно данным таблицы оптимальным выбором будет RabbitMQ, так как он удовлевторяет всем требованиям.   
  
  *Используемый материал:* https://www.okbsapr.ru/library/publications/shkola_kzi_chadov_mikhalchenko_2019/ и https://ultimate-comparisons.github.io/ultimate-message-broker-comparison/
